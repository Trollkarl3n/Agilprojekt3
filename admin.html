<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/stylesubpage.css" />
    <link rel="stylesheet" href="css/admin.css" />
    <script src="js/admin.js" type="module" defer></script>
    <script src="js/dashboard.js" type="module" defer></script> <!-- New script for low stock functionality -->
    <title>Admin Kontrollpanel</title>
</head>
<body class="subpage">
    <header>
        <section class="hero">
          <nav>
            <div class="logo">
              <h1><a href="index.html">Cool Fashion</a></h1>
            </div>
            <input type="checkbox" id="nav-toggle" class="nav-toggle" />
            <label for="nav-toggle" class="hamburger-menu">
              <span></span>
              <span></span>
              <span></span>
            </label>
            <ul class="main-menu">
              <li><a href="index.html">Hem</a></li>
              <li><a href="category.html?group=clothes">Kläder</a></li>
              <li><a href="category.html?group=skate">Test</a></li>
              <li><a href="productcart.html">Varukorg</a></li>
              <li><a href="wishlist.html">Önskelista</a></li>
              <li><a href="contact.html">Kontakt</a></li>
            </ul>
          </nav>
        </section>
    </header>
    <main>
        <!-- Low Stock Products Section -->
        <section>
            <h2>Produkter med låg lagernivå</h2>
            <div class="low-stock-products-grid">
                <ul id="low-stock-list"></ul>
            </div>
        </section>
        <hr />
        <!-- FORM: CREATE NEW CATEGORY -->
        <section>
            <h2>Skapa kategori</h2>
            <form id="create-category-form" method="POST">
                <div id="category-preview"></div>
                <div>
                    <label for="create-category-group">Typ</label>
                    <select id="create-category-group" name="category-group" required>
                        <option value="clothes">Kläder</option>
                        <option value="skate">Test</option>
                    </select>
                </div>
                <div>
                    <label for="create-category-name">Kategorinamn</label>
                    <input type="text" id="create-category-name" name="category-name" minlength="4" maxlength="20" required />
                </div>
                <div>
                    <label for="create-category-image">Kategoribild</label>
                    <input type="file" accept="image/*" id="create-category-image" name="category-image" required />
                </div>
                <button type="submit">Skapa</button>
            </form>
        </section>
        <hr />

        <!-- FORM: CREATE NEW PRODUCT -->
        <section>
            <h2>Skapa produkt</h2>
            <form id="create-product-form" method="POST">
                <div id="product-preview">
                    <img id="main-image-preview" src="" alt="Main Image Preview" />
                    <div>
                        <label for="main-image-select">Välj huvudbild:</label>
                        <select id="main-image-select">
                            <option value="0">Välj bild</option>
                            <option value="1">Bild 1</option>
                            <option value="2">Bild 2</option>
                            <option value="3">Bild 3</option>
                            <option value="4">Bild 4</option>
                            <option value="5">Bild 5</option>
                        </select>
                    </div>
                    <div class="thumbnails">
                        <img class="thumbnail" id="thumbnail-1" src="" alt="Thumbnail 1" />
                        <img class="thumbnail" id="thumbnail-2" src="" alt="Thumbnail 2" />
                        <img class="thumbnail" id="thumbnail-3" src="" alt="Thumbnail 3" />
                        <img class="thumbnail" id="thumbnail-4" src="" alt="Thumbnail 4" />
                        <img class="thumbnail" id="thumbnail-5" src="" alt="Thumbnail 5" />
                    </div>
                </div>
                <div>
                    <label for="create-product-name">Produktnamn</label>
                    <input id="create-product-name" name="product-name" type="text" minlength="4" maxlength="50" required />
                </div>
                <div>
                    <label for="create-product-price">Pris</label>
                    <input id="create-product-price" name="product-price" type="number" min="0" value="0" required />
                </div>
                <div>
                    <label for="create-product-desc">Produktbeskrivning</label>
                    <textarea id="create-product-desc" name="product-desc" rows="5" cols="60" required></textarea>
                </div>
                <!-- New Stock Quantity Input -->
                <div>
                    <label for="create-product-stock">Lagernivå</label>
                    <input id="create-product-stock" name="product-stock" type="number" min="0" required />
                </div>
                <!-- Additional image fields -->
                <div>
                    <label for="create-product-category">Kategori</label>
                    <select id="create-product-category" name="product-category" required></select>
                </div>
                <button type="submit">Skapa</button>
            </form>
        </section>
        <hr />

        <!-- FORM: EDIT PRODUCT -->
        <section>
          <h2>Redigera produkt</h2>
          <form id="edit-product-form" method="POST">
              <div>
                  <label for="edit-product-select">Välj produkt att redigera</label>
                  <select id="edit-product-select" name="productlist" required>
                  </select>
              </div>
              <div>
                  <label for="edit-product-name">Produktnamn</label>
                  <input type="text" id="edit-product-name" name="product-name" minlength="4" maxlength="50" required />
              </div>
              <div>
                  <label for="edit-product-desc">Beskrivning</label>
                  <textarea id="edit-product-desc" name="product-desc" minlength="10" required></textarea>
              </div>
              <div>
                  <label for="edit-product-price">Pris</label>
                  <input type="number" id="edit-product-price" name="product-price" min="0.01" step="0.01" required />
              </div>
              <div>
                  <label for="edit-product-stock">Lagernivå</label> 
                  <input type="number" id="edit-product-stock" name="product-stock" min="0" required />
              </div>
              <div>
                  <label for="edit-product-category">Kategori</label>
                  <select id="edit-product-category" name="product-category" required></select>
              </div>
              <button type="submit">Redigera</button>
          </form>
      </section>
      <section>
        <p>Total number of products: <span id="product-count">0</span></p>
    </section>
      <section>
        <p>10 Latest added products</p>
        <div id="latest-products" class="latest-products-container"></div>
        <script src="js/productstartpage.js" type="module"></script>
      </section>
    </main>
    <footer>
        <div class="footer-links"><a href="admin.html">Admin</a></div>
        <div class="footer-links"><a href="contact.html">Kontakt</a></div>
        <div class="footer-links"><a href="productsearch.html">Sök produkt</a></div>
    </footer>

    <script>
        // Image Preview for Category
        document.getElementById('create-category-image').addEventListener('change', function(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('category-preview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Category Image Preview" style="max-width: 200px;"/>`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = ''; // Clear the preview if no file is selected
            }
        });

        // Image Preview for Product Thumbnails
        document.querySelectorAll('.thumbnail').forEach((thumbnail, index) => {
            thumbnail.addEventListener('click', () => {
                const mainImagePreview = document.getElementById('main-image-preview');
                const file = document.getElementById('create-product-image').files[index];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mainImagePreview.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>
</body>
</html>
